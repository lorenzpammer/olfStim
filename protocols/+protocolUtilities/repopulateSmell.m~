function smell = repopulateSmell(smell,selectedProtocol)
%% repopulateSmell(smell,selectedProtocol)
% selectedProtocol is optional. If 

if nargin < 2
% Extract the gui handle structure from the appdata of the figure:
    h=appdataManager('olfStimGui','get','h');
    selectedProtocol = appdataManager('olfStimGui','get','selectedProtocol');
end

global olfactometerOdors;


%% Repopulate the trial structures

for i = 1 : length(smell.trial)
    % The 
    smell.trial(i).stimProtocol = selectedProtocol;
end

%% Set the session parameters.

% The positions of odorants can change in the olfactometer
smell.olfactometerOdors = olfactometerOdors;

end